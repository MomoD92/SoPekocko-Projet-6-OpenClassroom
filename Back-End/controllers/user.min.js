'use strict';const bcrypt=require("bcrypt"),User=require("../models/user"),jwt=require("jsonwebtoken");exports.signup=(c,b,e)=>{bcrypt.hash(c.body.password,10).then(a=>{(new User({email:c.body.email,password:a})).save().then(()=>b.status(201).json({message:"Utilisateur cr\u00e9\u00e9 !"})).catch(d=>b.status(400).json({error:d}))}).catch(a=>b.status(500).json({error:a}))};
exports.login=(c,b,e)=>{User.findOne({email:c.body.email}).then(a=>{if(!a)return b.status(401).json({error:"Utilisateur non trouv\u00e9 ! "});bcrypt.compare(c.body.password,a.password).then(d=>{if(!d)return b.status(401).json({error:"Mot de passe incorrect !"});b.status(200).json({userId:a._id,token:jwt.sign({userId:a._id},"RANDOM_TOKEN_SECRET",{expiresIn:"24h"})})}).catch(d=>b.status(500).json({error:d}))}).catch(a=>b.status(500).json({error:a}))};